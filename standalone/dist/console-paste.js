!function(){"use strict";const n="ading2210/edpuzzle-answers: a Javascript bookmarklet that provides many useful utilities for Edpuzzle\nCopyright (C) 2025 ading2210\n\nThis program is free software: you can redistribute it and/or modify it under the terms of the GNU Affero General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.\n\nThis program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License for more details.\n\nYou should have received a copy of the GNU Affero General Public License along with this program. If not, see <https://www.gnu.org/licenses/>.",e="edpuzzle.hs.vc",t='<!DOCTYPE html>\n\x3c!--  \nCopyright (C) 2023 ading2210\nSee README.md for more information\n--\x3e\n\n<html>\n  <head>\n    <title id="title">Loading resources...</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n  </head>\n  <body class="flex sm:w-screen sm:h-screen max-sm:flex-col text-slate-200 bg-slate-900">\n    <div id="header_div" class="flex flex-col sm:w-72 gap-2 p-3 bg-slate-800 sm:overflow-auto">\n      <div class="w-full">\n        <img id="thumbnail_img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAC0CAMAAADSOgUjAAAAAXNSR0IB2cksfwAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABtQTFRFzMzMAAAAZmZmMzMzTExMGRkZsrKyf39/mZmZsPv30QAAA9NJREFUeNrt29m2oyoURmHpFrz/Ex8wKkhjJSb7DHXM72pXbBL/ICwwNU0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/F21s/ocx/tkX+AesMvkfSunHBWiUI0ACJEACfCvAEIQAvwnwiQiQAAmQAAlwzFvjlDO2noNJ2uBUd5N+HRKaALUOxV56eYO4szNa6vd1Lr0cXsfJTQPUMaKF8/3X601i8+vhoA4UpWIqIZ+oPImfX3brSZQKtwxQjFKxacgkkhIz5cXHDT5I5O3u4iXt6CU1UZPyOg5QLzuHdH5f3PfxS0mNTkL80942wN1F+SJB2d22KeciP7ddbGxe+jBAnd8gnURyfrr8RuxNA6w+dxhOxCTnYHMMS5wHAeryDWTbWL1RatO3DDDsu6Vp0sPrMMo2UeYbehjg/nx2/SSmGrjlpgHaZotTg7VDve6q62P8YYC+2rX7JaTPeMcApb1jde7r6pjcGrFuQh8H6Oo3DEvLl+ZbuGGAvrmO7RJ7+452MEd94H7XpeX55msKtwxQdzaMhpH1mjuhH43C4f0Ab1hIm84czOw6QfHamDRfSMPkKPR/FNL7u90Pb+FbBmgPQ0118jxTeCX4uwCnZhCxfzxf/5sAe0NuTiNNwZz1sr+FOysHJwK0bRmjHxOg23olF9o+8DcBitr3FLEal4e1QHH7pH4b4Fw8SjEfvPAYfLIPrDsl/9M+MLXv12JF8GmRwV05v3GAvZ57bZWdSd7Ur0BO3cKxHM/rZe7iT0IP6kA1WjRoCg277Bs+qwMHAer5kFgkae395Z+DDgPslP9rPdY0tLUObCuQw5nIIECj7vQTpPFiQjuKrHd1HaDfAmxGEVFnyhj9iAB1fYXbMkl1p8o2E2mbrT0RoFeDJlgsFPb/vFaAda2Sd60qW6Ps1iSrCaBWJwJMy1dpEPZxGN79FuRmAaZPZvurcsXy+7zkHrYA98fEsuZMGbM8U1rkH2VeNUBp5L5tq8FC+YBEtg3psYaZcoBzEbwcE9K59ZkAX2OwtdYYVzz1u2iAHVPREpyN5YR1zdwtbogXqOYWVwS4bHodYmQ6GWDRk6SSUN80wOIBcFXPhvU4K9M+wPxgeL73vg6weGB3yQD/Sbzv1rPpJvODSVZI235XAlerC/jYpRcE78CPnmbh3QBpgV/ewoYQvhtENCl8V2oJKbzf4VlpykBPLB8NuSb/kjVYRX4f9nivmYwz5jUTLh4w4U3BbjPMojHis4YYwhP/ZxgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwDP8BGHcT4zxiQGEAAAAASUVORK5CYII=" class="rounded-lg mt-0.5">\n      </div>\n      <div id="title_div" class="space-y-1">\n        <p class="text-lg font-bold"><span id="assignment_title">Loading assignment data...</span></h2>\n        <p class="text-xs">Assigned by <span id="assignment_author" class="">[unknown]</span></p>\n        <p class="text-xs"><span id="assignment_end">Due [unknown]</span></p>\n        <p class="text-xs">Correct choices are <u>underlined</u>.</p>\n        <input id="skipper_button" class="ui_button" type="button" value="Skip Video" disabled/>\n        <input id="answers_button" class="ui_button" type="button" value="Answer Questions" disabled/>\n        <div id="speed_container" class="flex gap-1 items-center">\n          <label class="text-xs" for="speed_dropdown">Video speed:</label>\n          <select id="speed_dropdown" class="ui_button" name="speed_dropdown" disabled>\n            <option value="0.25">0.25</option>\n            <option value="0.5">0.5</option>\n            <option value="0.75">0.75</option>\n            <option value="1" selected>Normal</option>\n            <option value="1.25">1.25</option>\n            <option value="1.5">1.5</option>\n            <option value="1.75">1.75</option>\n            <option value="2">2</option>\n            <option value="-1">Custom</option>\n          </select>\n        </div>\n        <div id="custom_speed_container" class="gap-1 items-center hidden">\n          <label id="custom_speed_label" class="text-xs" for="custom_speed">Custom speed: <span id="custom_speed_value" class="font-mono"></span></label>\n          <input id="custom_speed" class="accent-slate-500" type="range" name="custom_speed" value="1" min="0.1" max="16" step="0.1">\n        </div>\n        <div id="options_container" class="flex gap-1 items-center">\n          <label for="unfocus_checkbox" class="text-xs">Don\'t pause on unfocus: </label>\n          <input id="unfocus_checkbox" class="accent-slate-500" type="checkbox" name="unfocus_checkbox" disabled>\n        </div>\n      </div>\n    </div>\n\n    <div id="content_div" class="flex flex-col flex-1 pt-3 gap-3 sm:overflow-auto"> \n      <p class="p-2 text-xs" id="status_text">\n        Loading assignment data...\n      </p>\n      \n      \x3c!-- templates for questions --\x3e\n      <table id="question_template" class="hidden mx-3">\n        <tr class="rounded-lg border-separate">\n          <td class="w-16 text-[13px] p-2.5 pr-0 align-top rounded-l-lg bg-slate-800">\n            <span key="timestamp"></span>\n          </td>\n          <td class="font-bold text-[13px] p-2 rounded-r-lg bg-slate-800">\n            <span key="title"></span>\n          </td>\n        </tr>\n        <tr>\n          <td></td>\n          <td key="question_content" class="text-xs p-2"></td>\n        </tr>\n      </table>\n      <ul id="multiple_choice_template" class="hidden list-disc">\n        <li key="question_choice" class="ml-6"></li>\n      </ul>\n      <div id="open_ended_template" class="hidden flex-col items-end gap-1">\n        <textarea key="question_textarea" class="textarea" rows=3 placeholder=\'Use the "Generate Response" button to generate an answer for this open-ended question.\'></textarea>\n        <div key="buttons_div" class="flex gap-1">\n          <button key="generator_button" class="p-1.5 rounded-md bg-slate-900 border border-slate-700">Generate Response</button>\n          <button key="submit_button" class="p-1.5 rounded-md bg-slate-900 border border-slate-700">Submit</button>\n        </div>\n      </div>\n      <div id="open_ended_menu_template" class="hidden flex-col w-full px-3 gap-2 text-xs">\n        <div class="w-full text-[13px] p-2.5 rounded-lg bg-slate-800 font-bold">\n          <p key="title"></p>\n        </div>\n        <div class="flex flex-col px-2 gap-1">\n          <p>Prompt:</p>\n          <textarea key="prompt_textarea" class="textarea" rows=4 placeholder="Loading prompt..." disabled></textarea>\n          <p class="mt-1">Generated:</p>\n          <textarea key="generated_textarea" class="textarea" rows=4 placeholder="Generated text will appear here."></textarea>\n          \n          <div class="flex items-center gap-2">\n            <p key="model_label">Model:</p>\n            <select key="model_dropdown" class="ui_button hidden">\n              <option value="default">Default</option>\n            </select>\n          </div>\n\n          <div class="flex items-center gap-2">\n            <button key="cancel_button" class="ui_button px-2 py-1">Cancel</button>\n            <div class="flex-1"></div>\n            <button key="generate_button" class="ui_button px-2 py-1">Generate</button>\n            <button key="save_button" class="ui_button px-2 py-1">Save</button>\n          </div>\n        </div>\n      </div>\n      \x3c!-- end templates --\x3e\n\n      <div id="questions_div" class="flex flex-col gap-1">\n      </div>\n      <div id="open_ended_div" class="hidden w-full">\n      </div>\n      \n      \x3c!-- spacer --\x3e\n      <div class="flex flex-1"></div>\n      \n      \x3c!-- footer --\x3e\n      <div id="footer" class="bg-slate-800 rounded-lg m-3 mt-0 p-3 text-[11px] flex flex-wrap gap-y-2">\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16 22.027v-2.87a3.37 3.37 0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7a5.44 5.44 0 00-1.5-3.75 5.07 5.07 0 00-.09-3.77s-1.18-.35-3.91 1.48a13.38 13.38 0 00-7 0c-2.73-1.83-3.91-1.48-3.91-1.48A5.07 5.07 0 005 5.797a5.44 5.44 0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7a3.37 3.37 0 00-.94 2.58v2.87M9 20.027c-3 .973-5.5 0-7-3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">Source Code:</p>\n            <a class="link" target="_blank" href="https://github.com/ading2210/edpuzzle-answers">ading2210/edpuzzle-answers</a>  \n          </div>\n        </div>\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 12c0 5.523 4.477 10 10 10s10-4.477 10-10S17.523 2 12 2 2 6.477 2 12z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M13 2.05S16 6 16 12c0 6-3 9.95-3 9.95M11 21.95S8 18 8 12c0-6 3-9.95 3-9.95M2.63 15.5h18.74M2.63 8.5h18.74" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">Website:</p>\n            <a class="link" target="_blank" href="https://edpuzzle.hs.vc">edpuzzle.hs.vc</a>          </div>\n        </div>\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 16c5 2.5 8 2.5 13 0M15.5 17.5l1 2s4.171-1.328 5.5-3.5c0-1 .53-8.147-3-10.5-1.5-1-4-1.5-4-1.5l-1 2h-2" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.528 17.5l-1 2s-4.171-1.328-5.5-3.5c0-1-.53-8.147 3-10.5 1.5-1 4-1.5 4-1.5l1 2h2" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M8.5 14c-.828 0-1.5-.895-1.5-2s.672-2 1.5-2 1.5.895 1.5 2-.672 2-1.5 2zM15.5 14c-.828 0-1.5-.895-1.5-2s.672-2 1.5-2 1.5.895 1.5 2-.672 2-1.5 2z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">Discord:</p>\n            <a class="link" target="_blank" href="https://edpuzzle.hs.vc/discord">edpuzzle.hs.vc/discord</a>\n          </div>\n        </div>\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 7v6M12 17.01l.01-.011M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">Report Bugs:</p>\n            <a class="link" target="_blank" href="https://github.com/ading2210/edpuzzle-answers/issues">Github Issues</a>\n          </div>\n        </div>\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 18h7M7 14h1M7 10h3M7 2h9.5L21 6.5V19" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M3 20.5v-14A1.5 1.5 0 014.5 5h9.752a.6.6 0 01.424.176l3.148 3.148A.6.6 0 0118 8.75V20.5a1.5 1.5 0 01-1.5 1.5h-12A1.5 1.5 0 013 20.5z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M14 5v3.4a.6.6 0 00.6.6H18" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">License:</p>\n            <a class="link" target="_blank" href="https://github.com/ading2210/edpuzzle-answers/blob/main/LICENSE">GNU AGPL v3</a>\n          </div>\n        </div>\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10zM13.5 9.17a3 3 0 100 5.659" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">Copyright:</p>\n            <a class="link" id="open-notice">View Notice</a>\n          </div>\n        </div>\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13 16h5M6 8l4 4-4 4" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2 18V6a2 2 0 012-2h16a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">Javascript Console:</p>\n            <a class="link" id="open-console">Open Console</a>\n          </div>\n        </div>\n        <div class="flex gap-2 items-center w-52">\n          <svg class="footer_icon" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 12V5.749a.6.6 0 00-.176-.425l-3.148-3.148A.6.6 0 0016.252 2H4.6a.6.6 0 00-.6.6v18.8a.6.6 0 00.6.6H13M8 10h8M8 6h4m-4 8h3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M16 2v3.4a.6.6 0 00.6.6H20M19.992 15.125l2.556.649c.266.068.453.31.445.584C22.821 22.116 19.5 23 19.5 23s-3.321-.884-3.493-6.642a.588.588 0 01.445-.584l2.556-.649c.323-.082.661-.082.984 0z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>\n          <div>\n            <p class="text-xs">Legal Documents:</p>\n            <a class="link" href="javascript:alert(\'Not written yet.\')">Privacy + Terms</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </body>\n</html>',s='<!DOCTYPE html>\n\n\x3c!--  \nCopyright (C) 2023 ading2210\nSee README.md for more information\n--\x3e\n\n<html>\n  <head>\n    <title id="title">edpuzzle-answers: JS Console</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n  </head>\n  <body class="flex flex-col h-screen w-screen bg-slate-900 text-slate-200 font-mono text-xs">\n    <div id="table_container" class="flex-1 flex flex-col overflow-y-auto w-full">\n      <table id="console_table" class="w-full border-collapse border border-slate-600 break-words">\n\n      </table>\n    </div>\n    <textarea id="js_input" class="h-20 p-1 resize-none bg-slate-800 border-t border-t-slate-600" placeholder="Type your JS code here. Press enter to execute and shift+enter for multiple lines."></textarea>\n  </body>\n</html>',o="@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');\n\n*,\n:after,\n:before {\n    border: 0 solid #e5e7eb;\n    box-sizing: border-box\n}\n\n:after,\n:before {\n    --tw-content: \"\"\n}\n\nhtml {\n    -webkit-text-size-adjust: 100%;\n    font-feature-settings: normal;\n    font-family: Poppins, ui-sans-serif, arial;\n    font-variation-settings: normal;\n    line-height: 1.5;\n    -moz-tab-size: 4;\n    -o-tab-size: 4;\n    tab-size: 4\n}\n\nbody {\n    line-height: inherit;\n    margin: 0\n}\n\nhr {\n    border-top-width: 1px;\n    color: inherit;\n    height: 0\n}\n\nabbr:where([title]) {\n    -webkit-text-decoration: underline dotted;\n    text-decoration: underline dotted\n}\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n    font-size: inherit;\n    font-weight: inherit\n}\n\na {\n    color: inherit;\n    text-decoration: inherit\n}\n\nb,\nstrong {\n    font-weight: bolder\n}\n\ncode,\nkbd,\npre,\nsamp {\n    font-family: monospace;\n    font-size: 1em\n}\n\nsmall {\n    font-size: 80%\n}\n\nsub,\nsup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: initial\n}\n\nsub {\n    bottom: -.25em\n}\n\nsup {\n    top: -.5em\n}\n\ntable {\n    border-collapse: collapse;\n    border-color: inherit;\n    text-indent: 0\n}\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n    font-feature-settings: inherit;\n    color: inherit;\n    font-family: inherit;\n    font-size: 100%;\n    font-variation-settings: inherit;\n    font-weight: inherit;\n    line-height: inherit;\n    margin: 0;\n    padding: 0\n}\n\nbutton,\nselect {\n    text-transform: none\n}\n\n[type=button],\n[type=reset],\n[type=submit],\nbutton {\n    -webkit-appearance: button;\n    background-color: initial;\n    background-image: none\n}\n\n:-moz-focusring {\n    outline: auto\n}\n\n:-moz-ui-invalid {\n    box-shadow: none\n}\n\nprogress {\n    vertical-align: initial\n}\n\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n    height: auto\n}\n\n[type=search] {\n    -webkit-appearance: textfield;\n    outline-offset: -2px\n}\n\n::-webkit-search-decoration {\n    -webkit-appearance: none\n}\n\n::-webkit-file-upload-button {\n    -webkit-appearance: button;\n    font: inherit\n}\n\nsummary {\n    display: list-item\n}\n\nblockquote,\ndd,\ndl,\nfigure,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\nhr,\np,\npre {\n    margin: 0\n}\n\nfieldset {\n    margin: 0\n}\n\nfieldset,\nlegend {\n    padding: 0\n}\n\nmenu,\nol,\nul {\n    list-style: none;\n    margin: 0;\n    padding: 0\n}\n\ndialog {\n    padding: 0\n}\n\ntextarea {\n    resize: vertical\n}\n\ninput::-moz-placeholder,\ntextarea::-moz-placeholder {\n    color: #9ca3af;\n    opacity: 1\n}\n\ninput::placeholder,\ntextarea::placeholder {\n    color: #9ca3af;\n    opacity: 1\n}\n\n[role=button],\nbutton {\n    cursor: pointer\n}\n\n:disabled {\n    cursor: default\n}\n\naudio,\ncanvas,\nembed,\niframe,\nimg,\nobject,\nsvg,\nvideo {\n    display: block;\n    vertical-align: middle\n}\n\nimg,\nvideo {\n    height: auto;\n    max-width: 100%\n}\n\n[hidden] {\n    display: none\n}\n\n*,\n::backdrop,\n:after,\n:before {\n    --tw-border-spacing-x: 0;\n    --tw-border-spacing-y: 0;\n    --tw-translate-x: 0;\n    --tw-translate-y: 0;\n    --tw-rotate: 0;\n    --tw-skew-x: 0;\n    --tw-skew-y: 0;\n    --tw-scale-x: 1;\n    --tw-scale-y: 1;\n    --tw-pan-x: ;\n    --tw-pan-y: ;\n    --tw-pinch-zoom: ;\n    --tw-scroll-snap-strictness: proximity;\n    --tw-gradient-from-position: ;\n    --tw-gradient-via-position: ;\n    --tw-gradient-to-position: ;\n    --tw-ordinal: ;\n    --tw-slashed-zero: ;\n    --tw-numeric-figure: ;\n    --tw-numeric-spacing: ;\n    --tw-numeric-fraction: ;\n    --tw-ring-inset: ;\n    --tw-ring-offset-width: 0px;\n    --tw-ring-offset-color: #fff;\n    --tw-ring-color: #3b82f680;\n    --tw-ring-offset-shadow: 0 0 #0000;\n    --tw-ring-shadow: 0 0 #0000;\n    --tw-shadow: 0 0 #0000;\n    --tw-shadow-colored: 0 0 #0000;\n    --tw-blur: ;\n    --tw-brightness: ;\n    --tw-contrast: ;\n    --tw-grayscale: ;\n    --tw-hue-rotate: ;\n    --tw-invert: ;\n    --tw-saturate: ;\n    --tw-sepia: ;\n    --tw-drop-shadow: ;\n    --tw-backdrop-blur: ;\n    --tw-backdrop-brightness: ;\n    --tw-backdrop-contrast: ;\n    --tw-backdrop-grayscale: ;\n    --tw-backdrop-hue-rotate: ;\n    --tw-backdrop-invert: ;\n    --tw-backdrop-opacity: ;\n    --tw-backdrop-saturate: ;\n    --tw-backdrop-sepia:\n}\n\n.ui_button {\n    --tw-bg-opacity: 1;\n    background-color: rgb(71 85 105/var(--tw-bg-opacity));\n    border-radius: .375rem;\n    font-size: 13px;\n    margin-bottom: .25rem;\n    margin-top: .25rem;\n    padding: .125rem .25rem\n}\n\n.ui_button:disabled {\n    --tw-bg-opacity: 1;\n    background-color: rgb(51 65 85/var(--tw-bg-opacity))\n}\n\n.link {\n    --tw-text-opacity: 1;\n    color: rgb(129 140 248/var(--tw-text-opacity))\n}\n\n.textarea {\n    --tw-border-opacity: 1;\n    --tw-bg-opacity: 1;\n    background-color: rgb(15 23 42/var(--tw-bg-opacity));\n    border-color: rgb(51 65 85/var(--tw-border-opacity));\n    border-radius: .5rem;\n    border-width: 1px;\n    overflow-y: hidden;\n    padding: .5rem;\n    resize: none;\n    width: 100%\n}\n\n.footer_icon {\n    stroke: #e2e8f0;\n    height: 1.5rem;\n    width: 1.5rem\n}\n\n.static {\n    position: static\n}\n\n.m-3 {\n    margin: .75rem\n}\n\n.mx-3 {\n    margin-left: .75rem;\n    margin-right: .75rem\n}\n\n.ml-6 {\n    margin-left: 1.5rem\n}\n\n.mt-0 {\n    margin-top: 0\n}\n\n.mt-0\\.5 {\n    margin-top: .125rem\n}\n\n.mt-1 {\n    margin-top: .25rem\n}\n\n.flex {\n    display: flex\n}\n\n.table {\n    display: table\n}\n\n.hidden {\n    display: none\n}\n\n.h-20 {\n    height: 5rem\n}\n\n.h-screen {\n    height: 100vh\n}\n\n.w-16 {\n    width: 4rem\n}\n\n.w-52 {\n    width: 13rem\n}\n\n.w-full {\n    width: 100%\n}\n\n.w-screen {\n    width: 100vw\n}\n\n.w-48 {\n    width: 12rem\n}\n\n.flex-1 {\n    flex: 1 1 0%\n}\n\n.border-collapse {\n    border-collapse: collapse\n}\n\n.border-separate {\n    border-collapse: initial\n}\n\n.resize-none {\n    resize: none\n}\n\n.list-disc {\n    list-style-type: disc\n}\n\n.flex-col {\n    flex-direction: column\n}\n\n.flex-wrap {\n    flex-wrap: wrap\n}\n\n.items-end {\n    align-items: flex-end\n}\n\n.items-center {\n    align-items: center\n}\n\n.gap-1 {\n    gap: .25rem\n}\n\n.gap-2 {\n    gap: .5rem\n}\n\n.gap-3 {\n    gap: .75rem\n}\n\n.gap-y-2 {\n    row-gap: .5rem\n}\n\n.space-y-1>:not([hidden])~:not([hidden]) {\n    --tw-space-y-reverse: 0;\n    margin-bottom: calc(.25rem*var(--tw-space-y-reverse));\n    margin-top: calc(.25rem*(1 - var(--tw-space-y-reverse)))\n}\n\n.overflow-y-auto {\n    overflow-y: auto\n}\n\n.break-words {\n    overflow-wrap: break-word\n}\n\n.rounded-lg {\n    border-radius: .5rem\n}\n\n.rounded-md {\n    border-radius: .375rem\n}\n\n.rounded-l-lg {\n    border-bottom-left-radius: .5rem;\n    border-top-left-radius: .5rem\n}\n\n.rounded-r-lg {\n    border-bottom-right-radius: .5rem;\n    border-top-right-radius: .5rem\n}\n\n.border {\n    border-width: 1px\n}\n\n.border-t {\n    border-top-width: 1px\n}\n\n.border-slate-600 {\n    --tw-border-opacity: 1;\n    border-color: rgb(71 85 105/var(--tw-border-opacity))\n}\n\n.border-slate-700 {\n    --tw-border-opacity: 1;\n    border-color: rgb(51 65 85/var(--tw-border-opacity))\n}\n\n.border-t-slate-600 {\n    --tw-border-opacity: 1;\n    border-top-color: rgb(71 85 105/var(--tw-border-opacity))\n}\n\n.bg-red-800 {\n    --tw-bg-opacity: 1;\n    background-color: rgb(153 27 27/var(--tw-bg-opacity))\n}\n\n.bg-slate-800 {\n    --tw-bg-opacity: 1;\n    background-color: rgb(30 41 59/var(--tw-bg-opacity))\n}\n\n.bg-slate-900 {\n    --tw-bg-opacity: 1;\n    background-color: rgb(15 23 42/var(--tw-bg-opacity))\n}\n\n.bg-yellow-700 {\n    --tw-bg-opacity: 1;\n    background-color: rgb(161 98 7/var(--tw-bg-opacity))\n}\n\n.p-1 {\n    padding: .25rem\n}\n\n.p-1\\.5 {\n    padding: .375rem\n}\n\n.p-2 {\n    padding: .5rem\n}\n\n.p-2\\.5 {\n    padding: .625rem\n}\n\n.p-3 {\n    padding: .75rem\n}\n\n.px-2 {\n    padding-left: .5rem;\n    padding-right: .5rem\n}\n\n.px-3 {\n    padding-left: .75rem;\n    padding-right: .75rem\n}\n\n.py-1 {\n    padding-bottom: .25rem;\n    padding-top: .25rem\n}\n\n.pr-0 {\n    padding-right: 0\n}\n\n.pt-3 {\n    padding-top: .75rem\n}\n\n.align-top {\n    vertical-align: top\n}\n\n.font-mono {\n    font-family: monospace\n}\n\n.text-\\[11px\\] {\n    font-size: 11px\n}\n\n.text-\\[13px\\] {\n    font-size: 13px\n}\n\n.text-lg {\n    font-size: 1.125rem;\n    line-height: 1.75rem\n}\n\n.text-xs {\n    font-size: .75rem;\n    line-height: 1rem\n}\n\n.font-bold {\n    font-weight: 700\n}\n\n.text-slate-200 {\n    --tw-text-opacity: 1;\n    color: rgb(226 232 240/var(--tw-text-opacity))\n}\n\n.underline {\n    text-decoration-line: underline\n}\n\n.accent-slate-500 {\n    accent-color: #64748b\n}\n\n@media (max-width:650px) {\n    #footer_container {\n        display: block\n    }\n\n    #footer_container>tbody>tr>td {\n        display: inline-block;\n        width: 210px\n    }\n}\n\n::-webkit-scrollbar {\n    background: #334155;\n    width: 10px\n}\n\n::-webkit-scrollbar-thumb {\n    background: #475569;\n    border-radius: 5px\n}\n\n::-webkit-scrollbar-thumb:hover {\n    background: #414f63\n}\n\ninput[type=checkbox]:not(:checked) {\n    filter: brightness(0) saturate(100%) invert(64%) sepia(11%) saturate(608%) hue-rotate(174deg) brightness(89%) contrast(87%)\n}\n\n@media not all and (min-width:640px) {\n    .max-sm\\:flex-col {\n        flex-direction: column\n    }\n}\n\n@media (min-width:640px) {\n    .sm\\:h-screen {\n        height: 100vh\n    }\n\n    .sm\\:w-72 {\n        width: 18rem\n    }\n\n    .sm\\:w-screen {\n        width: 100vw\n    }\n\n    .sm\\:overflow-auto {\n        overflow: auto\n    }\n}";function i(){if("edpuzzle.hs.vc"===window.location.hostname)return alert("To use this, drag this button into your bookmarks bar. Then, run it when you're on an Edpuzzle assignment."),!1;let n=window.location;if(window.__uv&&(n=window.__uv.location),window.canvasReadyState)return function(n){const e=n.href.split("/"),t=`/api/v1/courses/${e[4]}/assignments/${e[6]}`,s=new XMLHttpRequest;s.open("GET",t,!0),s.onload=function(){const n=JSON.parse(s.responseText).url,e=new XMLHttpRequest;e.open("GET",n,!0),e.onload=function(){const n=JSON.parse(e.responseText);alert('Please re-run this script in the newly opened tab. If nothing happens after pressing "ok", then allow popups on Canvas and try again.'),window.open(n.url)},e.send()},s.send()}(n),!1;if(window.schoologyMoreLess)return function(n){const e=n.href.split("/")[4],t=`/external_tool/${e}/launch/iframe`,s=new XMLHttpRequest;s.open("GET",t,!0),s.onload=function(){alert('Please re-run this script in the newly opened tab. If nothing happens after pressing "ok", then allow popups on Schoology and try again.');const n=s.responseText.replace(/<script[\s\S]+?<\/script>/,""),e=document.createElement("div");e.innerHTML=n;const t=e.querySelector("form"),o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name","ext_submit"),o.setAttribute("value","Allow"),t.appendChild(o),document.body.appendChild(t),t.submit()},s.send()}(n),!1;return!!/https?:\/\/edpuzzle\.com\/(lms\/lti\/)?assignments\/[a-f0-9]{1,30}\/(watch|view)/.test(n.href)||(alert("Please run this script on an Edpuzzle assignment. For reference, the URL should look like this:\nhttps://edpuzzle.com/assignments/{ASSIGNMENT_ID}/watch"),!1)}!function(){if(!i())return;const a=function(){const n={token:null,version:"3.0.0",source:"none"};window.__EDPUZZLE_DATA__&&(n.token=window.__EDPUZZLE_DATA__.token,n.version=window.__EDPUZZLE_DATA__.version||n.version,n.source="window.__EDPUZZLE_DATA__");n.token||(n.token=localStorage.getItem("token")||localStorage.getItem("edpuzzle_token"),n.token&&(n.source="localStorage"));if(!n.token){const e=document.cookie.split("; ").find(n=>n.startsWith("token="));e&&(n.token=e.split("=")[1],n.source="cookies")}if(!n.token&&window.webpackChunkedpuzzle_client_web)try{const e=window.webpackChunkedpuzzle_client_web,t=e.push([[Symbol()],{},n=>n]);e.pop();const s=t("./app_react/modules/store.js"),o=Object.values(s)[0].getState();n.token=o.user.authToken,n.source="webpack_store"}catch(n){console.warn("Failed to extract token from webpack store:",n)}return n}();window.addEventListener("message",function(n){if(n.data&&n.data.type)if("fetch_request"===n.data.type){const{id:e,url:t,options:s}=n.data;s.credentials||(s.credentials="include"),fetch(t,s).then(async t=>{const s=await t.text();n.source&&n.source.postMessage({type:"fetch_response",id:e,ok:t.ok,status:t.status,statusText:t.statusText,text:s},"*")}).catch(t=>{n.source&&n.source.postMessage({type:"fetch_error",id:e,error:t.message},"*")})}else"reload_opener"===n.data.type?window.location.reload():"manipulate_video"===n.data.type&&function(n){if("toggle_unfocus"===n.action){const e=n.value;if(void 0===document.visability_change){document.visability_change=e;const n=document.createElement("script");n.innerHTML='\n                    window.addEventListener("visibilitychange", function(event) {\n                        if (document.visability_change) {\n                            event.stopImmediatePropagation();\n                        }\n                    }, true);\n                ',document.body.appendChild(n)}document.visability_change=e}else if("set_speed"===n.action){const e=n.value,t=document.querySelector("video");if(t){Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype,"playbackRate").set.call(t,e);try{Object.defineProperty(t,"playbackRate",{set(){},get:()=>1})}catch(n){}}}else if("set_youtube_speed"===n.action){const e=n.value,t=document.querySelector("iframe");if(t&&window.YT&&window.YT.get){const n=window.YT.get(t.id);n&&n.setPlaybackRate(e)}}else if("set_vimeo_speed"===n.action){const e=n.value,t=document.querySelector("iframe");t&&window.Vimeo&&new window.Vimeo.Player(t).setPlaybackRate(e)}}(n.data)}),function(i){const a=function(i,a){const r={base_url:e,edpuzzle_data:a,gpl_text:n,console_html:s,real_location:i};return`<!DOCTYPE html>\n<html>\n<head>\n    <title id="title">Loading resources...</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <style>\n${o}\n    </style>\n</head>\n<body class="flex sm:w-screen sm:h-screen max-sm:flex-col text-slate-200 bg-slate-900">\n${function(n){const e=n.match(/<body[^>]*>([\s\S]*)<\/body>/i);return e?e[1]:n}(t)}\n<script>\n// Embedded data from opener\nwindow.EMBEDDED_DATA = ${JSON.stringify(r)};\n\n\n\n(async function() {\n\n// Restore global variables from embedded data\nconst embeddedData = window.EMBEDDED_DATA;\nconst base_url = embeddedData.base_url;\nconst edpuzzle_data = embeddedData.edpuzzle_data;\nconst real_location = embeddedData.real_location;\nconst gpl_text = embeddedData.gpl_text;\nconst console_html = embeddedData.console_html;\n\nlet media = null;\nlet questions = null;\nlet assignment = null;\nlet content_loaded = false;\nlet assignment_mode = null;\nlet attachment_id = null;\nconst console_log = [];\n\n// Parse attachment_id from URL\ntry {\n    const urlParams = new URL(real_location.href).searchParams;\n    attachment_id = urlParams.get("attachmentId");\n    // If not in URL, try to infer it later from assignment data\n} catch (e) {\n    console.warn("Could not parse attachment_id", e);\n}\n\n// UI Elements\nconst skipper_button = document.getElementById("skipper_button");\nconst answers_button = document.getElementById("answers_button");\nconst unfocus_checkbox = document.getElementById("unfocus_checkbox"); \nconst speed_button = document.getElementById("speed_button");\nconst speed_dropdown = document.getElementById("speed_dropdown");\nconst custom_speed_container = document.getElementById("custom_speed_container");\nconst custom_speed = document.getElementById("custom_speed");\nconst custom_speed_label = document.getElementById("custom_speed_label");\nconst custom_speed_value = document.getElementById("custom_speed_value");\nconst status_text = document.getElementById("status_text");\nconst questions_div = document.getElementById("questions_div");\nconst open_ended_div = document.getElementById("open_ended_div");\nconst content_div = document.getElementById("content_div");\nconst open_notice_button = document.getElementById("open-notice");\nconst open_console_button = document.getElementById("open-console");\n\n// Debug Data Object\nconst debugData = {\n    tokenSource: edpuzzle_data.source,\n    tokenPresent: !!edpuzzle_data.token,\n    apiVersion: edpuzzle_data.version,\n    backendUrl: base_url,\n    mediaId: null,\n    fetchErrors: []\n};\n\n// Logging helper\nfunction logDebug(message, data = null) {\n    const entry = { timestamp: new Date().toISOString(), message, data };\n    console.log("[EdpuzzleDebug]", message, data || "");\n    console_log.push(entry);\n    debugData.fetchErrors.push(entry);\n}\n\n// Proxy fetch wrapper to route requests through opener\nasync function fetch_wrapper(url, options = {}) {\n    // If it's an Edpuzzle API call, it needs auth cookies from the opener\n    if (url.includes("edpuzzle.com")) {\n        // Use postMessage relay\n        return new Promise((resolve, reject) => {\n            const id = Math.random().toString(36).substring(7);\n            \n            // Setup one-time listener for response\n            const handler = (event) => {\n                if (event.data.type === "fetch_response" && event.data.id === id) {\n                    window.removeEventListener("message", handler);\n                    resolve({\n                        ok: event.data.ok,\n                        status: event.data.status,\n                        statusText: event.data.statusText,\n                        text: () => Promise.resolve(event.data.text),\n                        json: () => Promise.resolve(JSON.parse(event.data.text))\n                    });\n                } else if (event.data.type === "fetch_error" && event.data.id === id) {\n                    window.removeEventListener("message", handler);\n                    reject(new Error(event.data.error));\n                }\n            };\n            window.addEventListener("message", handler);\n            \n            // Send request to opener\n            if (window.opener) {\n                window.opener.postMessage({\n                    type: "fetch_request",\n                    id: id,\n                    url: url,\n                    options: options\n                }, "*");\n            } else {\n                reject(new Error("Opener window lost"));\n            }\n        });\n    } else {\n        // Direct fetch for external calls (e.g., backend) - works because blob: has no CSP\n        return fetch(url, options);\n    }\n}\n\n\n// logic from app/main.js\n\n\nfunction sanitize_html(str) {\n  return str.replaceAll("<", "&lt;").replaceAll(">", "&gt;");\n}\n\nfunction get_template(id, flex=false) {\n  let element = document.getElementById(id).cloneNode(true);\n  element.removeAttribute("id");\n  element.classList.remove("hidden");\n  if (flex) {\n    element.classList.add("flex");\n  }\n\n  element.placeholder = function(name) {\n    return element.querySelector(\`*[key="\${name}"]\`)\n  }\n  return element;\n}\n\nfunction fixed_length_int(int, length) {\n  return ("0".repeat(length) + int).slice(-length);\n}\n\nfunction get_assignment_id() {\n  if (assignment) {\n    if (assignment_mode == "new") {\n      return assignment.assignmentLearner.assignmentId;\n    }\n    else {\n      return assignment.teacherAssignments[0]._id;\n    }\n  }\n  else {\n    let corrected_url = real_location.href.replace("/lms/lti", "");\n    return corrected_url.split("/")[4];\n  }\n}\n\nasync function get_csrf() {\n    // modifications:\n    // use opener to handle cookies, no explicit CSRF tokens\n    let csrf_url = "https://edpuzzle.com/api/v3/csrf";\n    let request = await fetch_wrapper(csrf_url);\n    let data = await request.json();\n    return data.CSRFToken;\n}\n\nasync function construct_headers() {\n    const headers = {\n        "accept": "application/json, text/plain, */*",\n        "content_type": "application/json"\n    };\n    \n    // legacy header\n    if (edpuzzle_data.token) {\n        headers["authorization"] = edpuzzle_data.token;\n    }\n    \n    let csrf = await get_csrf();\n    headers["x-csrf-token"] = csrf;\n    \n    return headers;\n}\n\nasync function get_attempt() {\n  let user_id = assignment.teacherAssignments[0].preferences.teacherId; //placeholder\n  // modified\n  \n  \n  let id = get_assignment_id();\n  let attempt;\n  \n  //let attempt_url;\n  if (assignment_mode == "new") {\n      let student_id = assignment.assignmentLearner.studentId; \n      attempt = assignment.assignmentLearner;\n\n  } else {\n       let url = "https://edpuzzle.com/api/v3/assignments/" + id + "/attempt";\n       let response = await fetch_wrapper(url);\n       attempt = await response.json();\n  }\n  return attempt;\n}\n\nasync function init() {\n  try {\n    // ui init\n    if (open_notice_button) {\n        open_notice_button.onclick = () => {\n             alert(gpl_text);\n        };\n    }\n    if (open_console_button) {\n        // The console is kinda broken. Sorry about that \n        open_console_button.onclick = () => {\n            const consoleWindow = window.open("", "_blank", "width=600,height=400");\n            if (consoleWindow) {\n\n                consoleWindow.document.open();\n                consoleWindow.document.write(console_html);\n                consoleWindow.document.close();\n                \n                // I tried different things to get it to style properly\n                // but it didn't work so it looks ugly rn\n                const style = consoleWindow.document.createElement("style");\n                style.textContent = POPUP_CSS;\n                consoleWindow.document.head.appendChild(style);\n                \n                // Inject logs, wait for dom?\n                setTimeout(() => {\n                    const table = consoleWindow.document.getElementById("console_table");\n                    if (table) {\n                        console_log.forEach(entry => {\n                            const row = consoleWindow.document.createElement("tr");\n\n                            row.innerHTML = \`<td class="p-1 border-r border-slate-600 w-32 shrink-0">\${entry.timestamp}</td><td class="p-1 break-words">\${entry.message} \${entry.data ? JSON.stringify(entry.data) : ""}</td>\`;\n                            table.appendChild(row);\n                        });\n                    }\n                }, 100);\n            }\n        };\n    }\n\n    // ----\n    // Added copy debug info feature\n    // this was really helpful for testing but you can remove it\n    // there was a convinent empty space in the bottom right of the footer\n    // ----\n\n    const footer = document.getElementById("footer");\n    if (footer) {\n        const debugLinkDiv = document.createElement("div");\n        debugLinkDiv.className = "flex gap-2 items-center w-52";\n        debugLinkDiv.innerHTML = \`\n           <svg class="footer_icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>\n           <div>\n             <p class="text-xs">Troubleshooting:</p>\n             <a class="link" href="#" id="copy_debug_btn">Copy Debug Info</a>\n           </div>\n        \`;\n        footer.appendChild(debugLinkDiv);\n        document.getElementById("copy_debug_btn").onclick = copyDebugInfo;\n    }\n\n\n    let assignment_id = get_assignment_id();\n    let url = "https://edpuzzle.com/api/v3/assignments/" + assignment_id;\n    \n    logDebug("Fetching assignment data", { url, token: edpuzzle_data.token ? "Present" : "Missing" });\n    \n    // add authorization header\n    const options = { credentials: 'include', headers: {} };\n    if (edpuzzle_data.token) {\n        options.headers["Authorization"] = "Bearer " + edpuzzle_data.token;\n    }\n    \n    let response = await fetch_wrapper(url, options);\n\n    if (response.ok) {\n        assignment = await response.json();\n        assignment_mode = "old"; \n    } else {\n        logDebug("Primary assignment fetch failed, trying 'new' mode fallback", response.status);\n        \n        let user_id;\n        try {\n             let me_url = "https://edpuzzle.com/api/v3/users/me";\n             let me_response = await fetch_wrapper(me_url, options);\n             if (!me_response.ok) throw new Error("Could not fetch user info");\n             let me_data = await me_response.json();\n             user_id = me_data._id;\n        } catch(e) {\n            throw new Error("Failed to get user ID for new assignment mode: " + e.message);\n        }\n        \n        let new_url = "https://edpuzzle.com/api/v3/learning/assignments/" + assignment_id + "/users/" + user_id;\n        logDebug("Fetching new assignment data", { new_url });\n        \n        response = await fetch_wrapper(new_url, options);\n        if (!response.ok) throw new Error("Failed to fetch new assignment data: " + response.status);\n        \n        assignment = await response.json();\n        assignment_mode = "new";\n    }\n    \n    logDebug("Assignment data received", { mode: assignment_mode });\n\n    // update ui\n    let title = document.getElementById("title");\n    if (title) title.innerText = "Edpuzzle Answers"; \n    \n    // populate media global\n    await get_questions(); \n    try {\n        let assignmentTitle = "Unknown Title";\n        let authorName = "Unknown Author";\n        let thumbnailSrc = "";\n        let dueDateText = "No due date";\n        \n        if (assignment_mode == "new") {\n            if (assignment.assignment) {\n                assignmentTitle = assignment.assignment.title;\n            }\n            if (assignment.teacher) {\n                authorName = assignment.teacher.name;\n            } else if (assignment.assignmentLearner && assignment.assignmentLearner.enrolledBy) {\n                authorName = assignment.assignmentLearner.enrolledBy.fullName;\n            }\n            \n            // thumbnail\n            if (media) {\n                thumbnailSrc = media.thumbnailUrl || media.thumbnailURL;\n\n                // not needed\n            //} else if (assignment.assignment && assignment.assignment.attachments) {\n            //     let att = assignment.assignment.attachments.find(a => a.id == attachment_id);\n            //     if (att) thumbnailSrc = att.thumbnailUrl;\n            }\n            \n            // due date\n            if (assignment.assignmentLearner && assignment.assignmentLearner.dueDate) {\n                dueDateText = "Due on " + (new Date(assignment.assignmentLearner.dueDate)).toDateString();\n            }\n\n        } else {\n             // old assignments\n             if (assignment.teacherAssignments && assignment.teacherAssignments[0]) {\n                 let ta = assignment.teacherAssignments[0];\n                 if (ta.classroom) assignmentTitle = ta.classroom.name;\n                 if (ta.preferences && ta.preferences.dueDate) {\n                     dueDateText = "Due on " + (new Date(ta.preferences.dueDate)).toDateString();\n                 }\n                 if (media) thumbnailSrc = media.thumbnailURL || media.thumbnailUrl;\n             }\n        }\n        \n        document.getElementById("assignment_title").innerText = assignmentTitle;\n        document.getElementById("assignment_author").innerText = authorName;\n        document.getElementById("assignment_end").innerText = dueDateText;\n        if (thumbnailSrc) {\n            if (thumbnailSrc.startsWith("/")) {\n                thumbnailSrc = "https://edpuzzle.com" + thumbnailSrc;\n            }\n            document.getElementById("thumbnail_img").src = thumbnailSrc;\n        }\n        \n    } catch(e) {\n        logDebug("Error updating UI", e.message);\n    }\n    \n    content_loaded = true;\n    skipper_button.disabled = false;\n    answers_button.disabled = false;\n    unfocus_checkbox.disabled = false;\n    speed_dropdown.disabled = false;\n\n    //or else it just says loading... forever and I'm too lazy to fix it properly\n    status_text.innerText = "Loaded successfully.";\n\n\n    parse_questions();\n\n    skipper_button.onclick = skip_video;\n    answers_button.onclick = answer_questions;\n    unfocus_checkbox.onchange = toggle_unfocus;\n    speed_dropdown.onchange = video_speed;\n    custom_speed.oninput = () => {\n         custom_speed_value.innerText = custom_speed.value;\n         video_speed();\n    };\n\n  } catch (error) {\n    status_text.innerHTML = "Error: " + error.message;\n    console.error(error);\n    logDebug("Init Error", error.message);\n  }\n}\n\n\nasync function get_media() {\n    let media_id;\n    if (assignment_mode == "new") {\n        let filtered = assignment.assignment.attachments.filter((attachment) => {\n            return attachment.id == attachment_id;\n        });\n        media_id = filtered[0].contentId;\n        // attachment_id unused in original main.js?\n\n        if (!media_id && assignment.assignment.contentId) media_id = assignment.assignment.contentId;\n    } else {\n        media_id = assignment.teacherAssignments[0].contentId;\n    }\n    debugData.mediaId = media_id;\n    logDebug("Fetching media from backend", { media_id, base_url });\n\n    // direct fetch because blob url\n    const headers = {};\n    if (edpuzzle_data.token) {\n        // Backend expects standard Bearer\n        headers["Authorization"] = "Bearer " + edpuzzle_data.token;\n    }\n    \n    try {\n        let r = await fetch(base_url + "/api/media/" + media_id, { headers });\n        if (!r.ok) {\n             throw new Error("Backend returned status: " + r.status);\n        }\n        media = await r.json();\n        \n        if (media.error) {\n           throw new Error(media.error);\n        }\n        \n        questions = media.questions;\n    } catch(e) {\n        logDebug("Backend fetch failed, trying local fallback", e.message);\n        \n        if (assignment && assignment.teacherAssignments && assignment.teacherAssignments.length > 0) {\n        }\n        \n        if (assignment && assignment.questions) {\n            questions = assignment.questions;\n            media = assignment; \n            logDebug("Used local fallback questions (Root assignment object)");\n        }\n        else if (assignment && assignment.assignment && assignment.assignment.questions) {\n            questions = assignment.assignment.questions;\n            media = assignment.assignment; \n            logDebug("Used local fallback questions (Nested assignment object)");\n        } else {\n            throw e;\n        }\n    }\n    return questions;\n}\n\n\n// logic from app/skipper.js\n// needs more testing\n\n\nasync function skip_video(attempt=null, update_button=true) {\n  if (update_button) {\n    skipper_button.value = "Skipping video...";\n    skipper_button.disabled = true;\n  }\n\n  if (!attempt) attempt = await get_attempt();\n  await post_watchtime(attempt);\n\n  if (update_button) {\n    skipper_button.value = "Video skipped successfully.";\n    if (window.opener) window.opener.postMessage({ type: 'reload_opener' }, '*');\n  }\n}\n\nasync function post_watchtime(attempt) {\n  let id = attempt._id || attempt.id;\n  let watch_url = "https://edpuzzle.com/api/v4/media_attempts/" + id + "/watch";\n  if (assignment_mode === "new") {\n    watch_url = "https://edpuzzle.com/api/v3/learning/time_intervals/submission/" + id + "/watch";\n  }\n  let content = { "timeIntervalNumber": 10 };\n  await fetch_wrapper(watch_url, {\n    method: "POST",\n    headers: await construct_headers(),\n    body: JSON.stringify(content)\n  });\n}\n\n\n// logic from app/autoanswers.js\n\n\n\nasync function answer_questions() {\n  answers_button.value = "Submitting answers...";\n  skipper_button.disabled = true;\n  answers_button.disabled = true;\n\n  let attempt = await get_attempt();\n  await skip_video(attempt, false);\n\n  let filtered_questions = filter_questions(questions);\n  await post_answers(attempt, filtered_questions, progress => {\n    answers_button.value = "Submitting answers (" + (progress + 1) + "/" + filtered_questions.length + ")...";\n  });\n\n  answers_button.value = "Answers submitted successfully.";\n  if (window.opener) window.opener.postMessage({ type: 'reload_opener' }, '*');\n}\n\nfunction filter_questions(questions_list) {\n  let filtered_questions = [];\n  for (let i = 0; i < questions_list.length; i++) {\n      let question = questions_list[i];\n      if (question.type != "multiple-choice") continue;\n      if (filtered_questions.length == 0) {\n          filtered_questions.push([question]);\n      } else if (filtered_questions[filtered_questions.length - 1][0].time == question.time) {\n          filtered_questions[filtered_questions.length - 1].push(question);\n      } else {\n          filtered_questions.push([question]);\n      }\n  }\n  return filtered_questions;\n}\n\nasync function post_answers(attempt, filtered_questions, progress_callback = null) {\n  let attempt_id = attempt._id || attempt.id;\n  for (let i = 0; i < filtered_questions.length; i++) {\n      let question_part = filtered_questions[i];\n      await post_answer(attempt_id, question_part);\n      if (progress_callback) {\n          progress_callback(i);\n      }\n  }\n}\n\nasync function post_answer(attempt_id, questions_part) {\n    let answers_url = "https://edpuzzle.com/api/v3/attempts/" + attempt_id + "/answers";\n    let content = { answers: [] };\n\n    if (assignment_mode === "new") {\n        answers_url = "https://edpuzzle.com/api/v3/learning/submissions/" + attempt_id + "/answers";\n        content = {\n            answerQuestions: [],\n            answerSaveStatus: "answered"\n        };\n    }\n\n    for (let i = 0; i < questions_part.length; i++) {\n        let question = questions_part[i];\n        let correct_choices = [];\n        for (let j = 0; j < question.choices.length; j++) {\n            let choice = question.choices[j];\n            if (choice.isCorrect) {\n                correct_choices.push(choice._id);\n            }\n        }\n        if (assignment_mode === "new") {\n            content.answerQuestions.push({\n                questionData: { choiceIds: correct_choices },\n                questionId: question._id,\n                questionType: "multiple-choice"\n            });\n        } else {\n            content.answers.push({\n                questionId: question._id,\n                choices: correct_choices,\n                type: "multiple-choice"\n            });\n        }\n    }\n\n    let response = await fetch_wrapper(answers_url, {\n        method: "POST",\n        headers: await construct_headers(),\n        body: JSON.stringify(content)\n    });\n\n    if (response.status === 429) {\n        await new Promise(resolve => setTimeout(resolve, 5000));\n        await post_answer(attempt_id, questions_part);\n    }\n}\n\n\n\n// logic from app/videooptions.js\n\n\n\n// Note: video manipulation needs to happen in the opener, not here\n// But the controls are here to send commands to opener\nfunction toggle_unfocus() {\n    sendVideoCommand('toggle_unfocus', unfocus_checkbox.checked);\n}\n\nfunction video_speed() {\n    let media_source = media.source; // media object should be available globally\n    let speed = parseFloat(speed_dropdown.value);\n    \n    // UI update logic from videooptions.js\n    if (speed == -1) {\n        custom_speed_container.classList.remove("hidden");\n        custom_speed_container.classList.add("flex");\n        speed = parseFloat(custom_speed.value);\n\n        //force changing the video speed\n        if (media_source == "edpuzzle") {\n            custom_speed.min = 0.1;\n            custom_speed.max = 9.9;\n            custom_speed.step = 0.1;\n            custom_speed_value.innerHTML = speed.toFixed(1);\n        } else if (media_source == "youtube" || media_source == "vimeo") {\n            custom_speed.min = 0.25;\n            custom_speed.max = 2;\n            custom_speed.step = 0.05;\n            custom_speed_value.innerHTML = speed.toFixed(2);\n        }\n    } else {\n        custom_speed_container.classList.remove("flex");\n        custom_speed_container.classList.add("hidden");\n    }\n\n    //send command\n    if (media_source == "edpuzzle") {\n        sendVideoCommand('set_speed', speed);\n    } else if (media_source == "youtube") {\n        sendVideoCommand('set_youtube_speed', speed);\n    } else if (media_source == "vimeo") {\n        sendVideoCommand('set_vimeo_speed', speed);\n    }\n}\n\nfunction sendVideoCommand(action, value) {\n    if (window.opener) {\n        window.opener.postMessage({\n            type: 'manipulate_video',\n            action: action,\n            value: value\n        }, '*');\n    }\n}\n\n// additional modification/helper func\n\nasync function get_responses(questions_list) {\n    let attempt = await get_attempt();\n    // This function matches responses to questions (for UI display of what we answered?)\n    // This logic was partly in main.js but we need it here.\n    if (!attempt) return questions_list;\n    \n    // Simplification: just return list for now unless we need the responses logic\n    // Actually, let's include it if we want to show what was answered.\n    // ... skipping for brevity unless needed ...\n    return questions_list;\n}\n\n// getting questions. Fallbacks due to some issues I had with different classes\n\nasync function get_questions() {\n    questions = await get_media(); // Fetch questions from backend\n    \n    let mc_questions = questions.filter(q => q.type === "multiple-choice");\n    if (mc_questions.length > 0) {\n        let valid_mc_count = 0;\n        \n        // Check if answers are in the local assignment object. This is vibe-coded (sorry)\n        let assignment_questions = [];\n        if (assignment && assignment.assignment && assignment.assignment.questions) {\n            assignment_questions = assignment.assignment.questions;\n        }\n\n        for (let question of mc_questions) {\n            let correct_found = false;\n            for (let choice of question.choices) {\n                if (choice.isCorrect) {\n                    correct_found = true;\n                    break;\n                }\n            }\n\n            // local fallback. As of 2/8/26, the edpuzzle.hs.vc api mirror returns questions without correct answers\n            // So here we try to still display them. Should be easy fix unless edpuzzle strengthens anti-bot measures\n\n            if (!correct_found && assignment_questions.length > 0) {\n                let local_q = assignment_questions.find(q => q._id === question._id);\n                if (local_q && local_q.choices) {\n                    local_q.choices.forEach((local_choice, index) => {\n                        if (local_choice.isCorrect && question.choices[index]) {\n                            question.choices[index].isCorrect = true;\n                            correct_found = true;\n                        }\n                    });\n                }\n            }\n\n            if (correct_found) {\n                valid_mc_count++;\n            }\n        }\n\n        if (valid_mc_count === 0) {\n            status_text.innerHTML = "<span class='text-amber-400'>Warning:</span> No answers found. (Is this assignment locked?)";\n        } else if (valid_mc_count < mc_questions.length) {\n            status_text.innerHTML = "<span class='text-amber-400'>Partial Success:</span> Found answers for " + valid_mc_count + "/" + mc_questions.length + " questions.";\n        }\n    }\n}\n\n\nfunction parse_questions() {\n    if (questions == null) return;\n\n    questions.sort((a, b) => a.time - b.time);\n\n    for (let question of questions) {\n        let min = fixed_length_int(Math.floor(question.time / 60), 2);\n        let secs = fixed_length_int(Math.floor(question.time % 60), 2);\n        let timestamp = "[" + min + ":" + secs + "]";\n\n        if (question.body[0].text != "") {\n            question.title = "<p>" + question.body[0].text + "</p>";\n        } else {\n            question.title = question.body[0].html;\n        }\n\n        let table = get_template("question_template");\n        table.placeholder("timestamp").innerHTML = timestamp;\n        table.placeholder("title").innerHTML = question.title;\n\n        if (question.type == "multiple-choice") {\n            let choices_list = get_template("multiple_choice_template");\n            let choice_template = choices_list.placeholder("question_choice");\n            for (let choice of question.choices) {\n                let list_item = choice_template.cloneNode(true);\n                if (choice.isCorrect) {\n                    list_item.classList.add("underline");\n                }\n                if (choice.body[0].text != "") {\n                    list_item.innerHTML = "<p>" + choice.body[0].text + "</p>";\n                } else {\n                    list_item.innerHTML = choice.body[0].html;\n                }\n                choices_list.append(list_item);\n            }\n            choice_template.remove();\n            table.placeholder("question_content").append(choices_list);\n        } \n        \n        questions_div.append(table);\n    }\n}\n\n// debug copy. Again very helpful for testing\nfunction copyDebugInfo() {\n    const info = {\n        userAgent: navigator.userAgent,\n        ...debugData,\n        logs: console_log\n    };\n    navigator.clipboard.writeText(JSON.stringify(info, null, 2)).then(() => {\n        alert("Debug info copied to clipboard!");\n    });\n}\n\ninit();\n\n})();\n//end popup\n        \n<\/script>\n</body>\n</html>`}(window.location,i),r=new Blob([a],{type:"text/html"}),l=URL.createObjectURL(r);window.open(l,"_blank","width=800,height=600"),setTimeout(()=>URL.revokeObjectURL(l),1e4)}(a)}()}();